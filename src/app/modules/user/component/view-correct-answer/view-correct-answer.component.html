<div *ngIf="testDetails; else loading">
  <!-- Test Details -->
  <div class="test-details">
    <h2>{{ testDetails.testDto.title }}</h2>
    <p>{{ testDetails.testDto.description }}</p>
    <p><strong>Test Duration:</strong> {{ formatTime(testDetails.testDto.time) }}</p>
  </div>

  <!-- Questions -->
  <div *ngFor="let question of paginatedQuestions; let i = index" class="question">
    <h3>Question {{ getQuestionNumber(i) }}: {{ question.questionText }}</h3>
    <p><strong>Type:</strong> {{ question.questionType }}</p>

    <!-- Options -->
    <div *ngFor="let option of question.options" class="option">
      <label>
        <span [class.correct]="isCorrectAnswer(question, option.optionText)">
          {{ option.optionText }}
          <span *ngIf="isCorrectAnswer(question, option.optionText)" class="correct-badge">✓ Correct</span>
        </span>
      </label>
    </div>

    <!-- User's Answer -->
    <div *ngIf="userAnswers[i]" class="user-answer">
      <p><strong>Your Answer:</strong> {{ userAnswers[i].selectedOptions.join(', ') }}</p>
      <p [class.correct]="isUserAnswerCorrect(question, userAnswers[i])" 
         [class.incorrect]="!isUserAnswerCorrect(question, userAnswers[i])">
        {{ isUserAnswerCorrect(question, userAnswers[i]) ? '✓ Correct' : '✗ Incorrect' }}
      </p>
    </div>
  </div>

  <!-- Pagination -->
  <div class="pagination">
    <nz-pagination
      [nzPageIndex]="currentPage"
      [nzTotal]="testDetails.questions.length"
      [nzPageSize]="pageSize"
      (nzPageIndexChange)="onPageChange($event)"
    ></nz-pagination>
  </div>
</div>

<ng-template #loading>
  <p>Loading test details...</p>
</ng-template>